# OSI 7계층 정리 📚

---

## 🎯 OSI 7계층이란?

**OSI (Open Systems Interconnection) 7계층 모델**은 네트워크 통신을 7개의 논리적 계층으로 나눈 국제 표준이다.

### 핵심 목적
- **표준화**: 서로 다른 시스템 간 호환성 확보
- **모듈화**: 각 계층의 독립적 개발과 문제 해결
- **추상화**: 복잡한 네트워크를 이해하기 쉽게 분할

---

## 📦 택배 비유로 이해하는 OSI 7계층

### 송신 과정 (7계층 → 1계층)

```
7계층 (Application): "편지를 써서 보내자"
   ↓ 편지 작성
6계층 (Presentation): "편지를 암호화해서 봉투에 넣자"
   ↓ [암호화된 편지]
5계층 (Session): "배송 출발을 알리고 연결을 지속하자"
   ↓ [연결정보] + [암호화된 편지]
4계층 (Transport): "어떤 택배회사로 보낼까? (일반 vs 등기)"
   ↓ [택배라벨] + [연결정보] + [암호화된 편지]
3계층 (Network): "네비게이션으로 최적 경로 선택"
   ↓ [주소라벨] + [택배라벨] + [연결정보] + [암호화된 편지]
2계층 (Data Link): "어느 구, 동네로 갈지 결정"
   ↓ [동네라벨] + [주소라벨] + [택배라벨] + [연결정보] + [암호화된 편지]
1계층 (Physical): "트럭으로 실제 운송 시작"
   ↓ 🚛💨 물리적 전송
```

### 수신 과정 (1계층 → 7계층)

```
1계층: 🚛 "트럭이 도착했어!"
   ↓ 택배 하차
2계층: "동네라벨 확인 → 맞네, 다음 단계로"
   ↓ [주소라벨] + [택배라벨] + [연결정보] + [암호화된 편지]
3계층: "주소라벨 확인 → 목적지 맞네, 다음 단계로"
   ↓ [택배라벨] + [연결정보] + [암호화된 편지]
4계층: "택배라벨 확인 → 등기 서명 받고, 다음 단계로"
   ↓ [연결정보] + [암호화된 편지]
5계층: "배송 완료 알림, 연결 종료"
   ↓ [암호화된 편지]
6계층: "암호화 해독 → 원본 편지 복원"
   ↓ [편지]
7계층: "편지 읽기 완료!"
   ↓ 사용자가 내용 확인
```

---

## 🏗️ 각 계층별 상세 설명

### 7계층 - Application Layer (응용 계층)
- **역할**: 사용자가 직접 사용하는 네트워크 서비스
- **프로토콜**: HTTP, HTTPS, FTP, SMTP
- **택배 비유**: "어떤 물건을 보낼지 결정"
- **예시**: `HttpURLConnection`, `RestTemplate`

### 6계층 - Presentation Layer (표현 계층)
- **역할**: 데이터 형식 변환, 암호화, 압축
- **기능**: 인코딩/디코딩, SSL/TLS
- **택배 비유**: "편지를 암호화하고 포장"
- **예시**: `"안녕".getBytes("UTF-8")`, SSL 인증서

### 5계층 - Session Layer (세션 계층)
- **역할**: 연결 상태 관리 (시작, 유지, 종료)
- **기능**: 세션 생성/해제, 상태 추적
- **택배 비유**: "배송 출발 알림, 배송 완료까지 연결 지속"
- **예시**: `socket.connect()`, `socket.close()`

### 4계층 - Transport Layer (전송 계층)
- **역할**: 프로세스 간 통신, 신뢰성 보장
- **프로토콜**: TCP (신뢰성), UDP (속도)
- **택배 비유**: "일반택배 vs 등기택배 선택"
- **예시**: `Socket` (TCP), `DatagramSocket` (UDP)

### 3계층 - Network Layer (네트워크 계층)
- **역할**: 네트워크 간 경로 설정, 라우팅
- **프로토콜**: IP, ICMP
- **택배 비유**: "네비게이션으로 최적 경로 선택"
- **예시**: `InetAddress.getByName("google.com")`

### 2계층 - Data Link Layer (데이터 링크 계층)
- **역할**: 같은 네트워크 내 기기 간 통신
- **기능**: MAC 주소, 이더넷 프레임
- **택배 비유**: "어느 구, 동네인지 찾기"
- **예시**: `NetworkInterface.getHardwareAddress()`

### 1계층 - Physical Layer (물리 계층)
- **역할**: 실제 전기 신호 전송
- **매체**: 케이블, WiFi, 광섬유
- **택배 비유**: "트럭으로 실제 운송"
- **예시**: 직접 제어 불가 (하드웨어 처리)

---

## 📋 PDU (Protocol Data Unit) - 각 계층의 데이터 이름

| 계층 | PDU 이름 | 설명 | 택배 비유 |
|------|----------|------|-----------|
| 7,6,5계층 | **Data** | 아직 전송 준비 안 된 순수 데이터 | "편지" |
| 4계층 | **Segment** | 전송 방법이 결정된 데이터 | "택배 상자" |
| 3계층 | **Packet** | 목적지가 결정된 데이터 | "주소 붙은 택배" |
| 2계층 | **Frame** | 실제 전송 준비 완료된 데이터 | "트럭에 실린 택배" |
| 1계층 | **Bit** | 물리적 전송 중인 데이터 | "움직이는 트럭" |

### 🔑 PDU 변화의 핵심
- **헤더 추가 시점**에 따라 PDU 이름이 변경됨
- 6계층 인코딩 = "내용 준비" (여전히 Data)
- 4계층 TCP 헤더 = "전송 준비" (Segment로 변경!)

---

## 🔧 헤더의 역할

### 헤더란?
각 계층이 자신의 역할을 수행하기 위해 데이터 앞에 붙이는 **"작업 지시서"**

### 헤더 추가/제거 과정
```
송신측: 헤더 추가 (캡슐화)
[MAC][IP][TCP][세션][SSL]"Hello" → 전송

수신측: 헤더 제거 (역캡슐화)  
[MAC][IP][TCP][세션][SSL]"Hello" → "Hello"
```

### 왜 제거하나?
- 각 계층이 **자기 역할을 완료**하면 해당 헤더는 불필요
- 상위 계층에서는 하위 계층 정보가 필요 없음

---

## 🚨 계층별 대표 오류와 해결법

| 계층 | 대표 오류 | 증상 | 해결법 |
|------|-----------|------|--------|
| 7계층 | HTTP 404, 500 | 특정 페이지/기능 오류 | 코드 수정, 서버 재시작 |
| 6계층 | SSL 인증서 만료 | HTTPS 접속 차단 | 인증서 갱신 |
| 5계층 | 세션 타임아웃 | 중간에 연결 끊김 | 재연결, 타임아웃 설정 |
| 4계층 | 포트 막힘 | 특정 서비스 접속 안 됨 | 방화벽 설정, 포트 확인 |
| 3계층 | 라우팅 실패 | 다른 네트워크 접속 안 됨 | 라우터 설정, DNS 확인 |
| 2계층 | MAC 주소 충돌 | 같은 네트워크 내 통신 실패 | 네트워크 장비 재시작 |
| 1계층 | 케이블 끊김 | 아예 연결 안 됨 | 물리적 연결 복구 |

### 🎯 실무 디버깅 순서
**4계층 → 3계층 → 7계층 → 5계층 → 2계층 → 1계층 → 6계층**
- 이유: 포트/방화벽 문제가 가장 흔하기 때문

---

## 🌐 현대 웹 개발에서의 OSI 7계층

### 개발자가 주로 다루는 계층
- **7계층**: HTTP, REST API, WebSocket
- **6계층**: HTTPS, 데이터 압축
- **나머지**: 프레임워크와 OS가 자동 처리

### 왜 7계층만 다루게 됐나?
1. **생산성 향상**: 비즈니스 로직에 집중
2. **학습 곡선 감소**: 네트워크 전문가가 아니어도 개발 가능
3. **역할 분리**: 하위 계층은 인프라팀이 담당

### 장점과 단점
- **장점**: 빠른 개발, 쉬운 유지보수
- **단점**: 네트워크 문제 발생 시 디버깅 어려움

---

## 💡 핵심 개념 정리

### OSI 7계층의 3가지 핵심
1. **표준화**: 서로 다른 시스템 간 호환성
2. **모듈화**: 각 계층의 독립적 역할
3. **추상화**: 복잡한 네트워크의 단순화

### 택배 비유의 핵심
- **송신**: 포장 → 라벨 붙이기 → 운송
- **수신**: 운송 → 라벨 확인 → 포장 해체
- **각 단계**: 독립적이지만 협력적

### PDU 변화의 핵심
- **Data**: 전송 준비 전 (7,6,5계층)
- **Segment**: 전송 방법 결정 (4계층)
- **Packet**: 목적지 결정 (3계층)
- **Frame**: 실제 전송 준비 (2계층)
- **Bit**: 물리적 전송 (1계층)

---